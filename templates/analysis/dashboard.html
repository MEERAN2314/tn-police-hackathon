{% extends "base.html" %}

{% block title %}Analysis Dashboard - TOR Analysis System{% endblock %}

{% block content %}
<div class="page-header">
    <div class="flex justify-between items-center">
        <div>
            <h1 class="page-title">Analysis Dashboard</h1>
            <p class="page-subtitle">Advanced TOR network analysis and pattern recognition tools</p>
        </div>
    </div>
</div>

<!-- Analysis Tools Grid -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
    <!-- Correlation Analysis -->
    <div class="card hover:shadow-lg transition-shadow">
        <div class="card-body text-center">
            <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <svg class="w-8 h-8 text-blue-600" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"/>
                </svg>
            </div>
            <h3 class="text-lg font-semibold mb-2">Correlation Analysis</h3>
            <p class="text-gray-600 mb-4">Analyze traffic patterns and timing correlations</p>
            <button class="btn btn-primary w-full analysis-btn" data-analysis="correlation">
                Run Analysis
            </button>
        </div>
    </div>

    <!-- Pattern Recognition -->
    <div class="card hover:shadow-lg transition-shadow">
        <div class="card-body text-center">
            <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <svg class="w-8 h-8 text-green-600" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M19,19H5V5H19V19Z"/>
                </svg>
            </div>
            <h3 class="text-lg font-semibold mb-2">Pattern Recognition</h3>
            <p class="text-gray-600 mb-4">ML-based pattern detection and clustering</p>
            <button class="btn btn-primary w-full analysis-btn" data-analysis="pattern">
                Detect Patterns
            </button>
        </div>
    </div>

    <!-- AI Analysis -->
    <div class="card hover:shadow-lg transition-shadow">
        <div class="card-body text-center">
            <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <svg class="w-8 h-8 text-purple-600" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M11,6V8H13V6H11M11,10V18H13V10H11Z"/>
                </svg>
            </div>
            <h3 class="text-lg font-semibold mb-2">AI Analysis</h3>
            <p class="text-gray-600 mb-4">AI-powered threat assessment and insights</p>
            <button class="btn btn-primary w-full analysis-btn" data-analysis="ai">
                AI Analyze
            </button>
        </div>
    </div>

    <!-- Network Topology -->
    <div class="card hover:shadow-lg transition-shadow">
        <div class="card-body text-center">
            <div class="w-16 h-16 bg-cyan-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <svg class="w-8 h-8 text-cyan-600" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M1 9l2 2c4.97-4.97 13.03-4.97 18 0l2-2C16.93 2.93 7.07 2.93 1 9zm8 8l3 3 3-3c-1.65-1.66-4.34-1.66-6 0zm-4-4l2 2c2.76-2.76 7.24-2.76 10 0l2-2C15.14 9.14 8.87 9.14 5 13z"/>
                </svg>
            </div>
            <h3 class="text-lg font-semibold mb-2">Network Topology</h3>
            <p class="text-gray-600 mb-4">Analyze network structure and relationships</p>
            <button class="btn btn-primary w-full" onclick="window.location.href='/network'">
                View Network
            </button>
        </div>
    </div>

    <!-- Threat Detection -->
    <div class="card hover:shadow-lg transition-shadow">
        <div class="card-body text-center">
            <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <svg class="w-8 h-8 text-red-600" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M12,7C13.4,7 14.8,8.6 14.8,10V11.5C15.4,11.5 16,12.1 16,12.7V16.2C16,16.8 15.4,17.3 14.8,17.3H9.2C8.6,17.3 8,16.8 8,16.2V12.8C8,12.2 8.6,11.7 9.2,11.7V10C9.2,8.6 10.6,7 12,7M12,8.2C11.2,8.2 10.5,8.7 10.5,9.5V11.5H13.5V9.5C13.5,8.7 12.8,8.2 12,8.2Z"/>
                </svg>
            </div>
            <h3 class="text-lg font-semibold mb-2">Threat Detection</h3>
            <p class="text-gray-600 mb-4">Identify suspicious activities and threats</p>
            <button class="btn btn-primary w-full analysis-btn" data-analysis="threat">
                Scan Threats
            </button>
        </div>
    </div>

    <!-- Report Generation -->
    <div class="card hover:shadow-lg transition-shadow">
        <div class="card-body text-center">
            <div class="w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <svg class="w-8 h-8 text-yellow-600" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                </svg>
            </div>
            <h3 class="text-lg font-semibold mb-2">Generate Report</h3>
            <p class="text-gray-600 mb-4">Create comprehensive analysis reports</p>
            <button class="btn btn-primary w-full" onclick="window.location.href='/reports'">
                Create Report
            </button>
        </div>
    </div>
</div>

<!-- Recent Analysis Results -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">Recent Analysis Results</h3>
    </div>
    <div class="card-body">
        <div class="space-y-4">
            <div class="flex items-center justify-between p-4 bg-green-50 border border-green-200 rounded-lg">
                <div class="flex items-center">
                    <div class="w-3 h-3 bg-green-500 rounded-full mr-3"></div>
                    <div>
                        <h4 class="font-semibold">Correlation Analysis</h4>
                        <p class="text-sm text-gray-600">Found 23 high-confidence correlations</p>
                    </div>
                </div>
                <div class="text-sm text-gray-500">2 minutes ago</div>
            </div>

            <div class="flex items-center justify-between p-4 bg-blue-50 border border-blue-200 rounded-lg">
                <div class="flex items-center">
                    <div class="w-3 h-3 bg-blue-500 rounded-full mr-3"></div>
                    <div>
                        <h4 class="font-semibold">Pattern Recognition</h4>
                        <p class="text-sm text-gray-600">Identified 5 suspicious traffic patterns</p>
                    </div>
                </div>
                <div class="text-sm text-gray-500">15 minutes ago</div>
            </div>

            <div class="flex items-center justify-between p-4 bg-purple-50 border border-purple-200 rounded-lg">
                <div class="flex items-center">
                    <div class="w-3 h-3 bg-purple-500 rounded-full mr-3"></div>
                    <div>
                        <h4 class="font-semibold">AI Threat Assessment</h4>
                        <p class="text-sm text-gray-600">Medium threat level detected</p>
                    </div>
                </div>
                <div class="text-sm text-gray-500">1 hour ago</div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.querySelectorAll('.analysis-btn').forEach(btn => {
    btn.addEventListener('click', async (e) => {
        const analysisType = e.target.dataset.analysis;
        const originalText = e.target.innerHTML;
        
        // Show loading state
        e.target.innerHTML = '<div class="spinner w-4 h-4 mr-2"></div>Running...';
        e.target.disabled = true;
        
        try {
            // Simulate analysis
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            // Show success
            window.torApp.showNotification(`${analysisType} analysis completed`, 'success');
            
            // Reset button
            e.target.innerHTML = originalText;
            e.target.disabled = false;
            
        } catch (error) {
            window.torApp.showNotification(`${analysisType} analysis failed`, 'error');
            e.target.innerHTML = originalText;
            e.target.disabled = false;
        }
    });
});
</script>
{% endblock %}